city_population = {
  "Delhi": 29617000,
  "Mumbai": 23355000,
  "Kolkāta": 17560000,
  "Bangalore": 13707000,
  "Chennai": 11324000,
  "Hyderābād": 9746000,
  "Pune": 7764000,
  "Ahmedabad": 7410000,
  "Sūrat": 5807000,
  "Lucknow": 3382000,
  "Jaipur": 3073350,
  "Cawnpore": 2701324,
  "Mirzāpur": 2496970,
  "Nāgpur": 2405665,
  "Ghāziābād": 2381452,
  "Indore": 2201927,
  "Vadodara": 2065771,
  "Vishākhapatnam": 2035922,
  "Bhopāl": 1883381,
  "Chinchvad": 1729320,
  "Patna": 1684222,
  "Ludhiāna": 1649000,
  "Āgra": 1585705,
  "Kalyān": 1576614,
  "Madurai": 1561129,
  "Jamshedpur": 1558000,
  "Nāsik": 1486053,
  "Farīdābād": 1394000,
  "Aurangābād": 95929,
  "Rājkot": 1335397,
  "Meerut": 1305429,
  "Jabalpur": 1267564,
  "Thāne": 1261517,
  "Dhanbād": 1246000,
  "Allahābād": 1201000,
  "Vārānasi": 1198491,
  "Srīnagar": 1180570,
  "Amritsar": 1132383,
  "Alīgarh": 1131160,
  "Bhiwandi": 1125898,
  "Gwalior": 1101981,
  "Bhilai": 1097000,
  "Hāora": 1077075,
  "Rānchi": 1073440,
  "Bezwāda": 1048240,
  "Chandīgarh": 1026459,
  "Mysore": 1014227,
  "Raipur": 1010087,
  "Kota": 1001694,
  "Bareilly": 1000000,
  "Jodhpur": 995000,
  "Coimbatore": 959823,
  "Dispur": 957352,
  "Guwāhāti": 957352,
  "Solāpur": 951558,
  "Trichinopoly": 916857,
  "Hubli": 890000,
  "Jalandhar": 873725,
  "Bhubaneshwar": 837737,
  "Bhayandar": 814655,
  "Morādābād": 787000,
  "Kolhāpur": 750000,
  "Thiruvananthapuram": 743691,
  "Sahāranpur": 705478,
  "Warangal": 704570,
  "Salem": 693236,
  "Mālegaon": 690844,
  "Kochi": 677381,
  "Gorakhpur": 673446,
  "Shimoga": 654055,
  "Tiruppūr": 650000,
  "Guntūr": 647508,
  "Raurkela": 625831,
  "Mangalore": 623841,
  "Nānded": 623708,
  "Cuttack": 606007,
  "Chānda": 595118,
  "Dehra Dūn": 578420,
  "Durgāpur": 566517,
  "Āsansol": 563917,
  "Bhāvnagar": 554978,
  "Amrāvati": 549370,
  "Nellore": 547621,
  "Ajmer": 542321,
  "Tinnevelly": 542200,
  "Bīkaner": 529007,
  "Agartala": 522613,
  "Ujjain": 515215,
  "Jhānsi": 507000,
  "Ulhāsnagar": 506098,
  "Davangere": 503564,
  "Jammu": 502197,
  "Belgaum": 488157,
  "Gulbarga": 483615,
  "Jāmnagar": 479920,
  "Dhūlia": 479073,
  "Gaya": 474093,
  "Jalgaon": 460468,
  "Kurnool": 457633,
  "Udaipur": 451100,
  "Bellary": 445388,
  "Sāngli": 436639,
  "Tuticorin": 436094,
  "Calicut": 431560,
  "Akola": 425817,
  "Bhāgalpur": 410210,
  "Sīkar": 400000,
  "Tumkūr": 399606,
  "Quilon": 397419,
  "Muzaffarnagar": 392451,
  "Bhīlwāra": 389911,
  "Nizāmābād": 388505,
  "Bhātpāra": 386019,
  "Kākināda": 384182,
  "Parbhani": 378326,
  "Pānihāti": 377347,
  "Lātūr": 374394,
  "Rohtak": 374292,
  "Rājapālaiyam": 369991,
  "Ahmadnagar": 350859,
  "Cuddapah": 344893,
  "Rājahmundry": 341831,
  "Alwar": 341422,
  "Muzaffarpur": 333200,
  "Bilāspur": 331030,
  "Mathura": 330511,
  "Kāmārhāti": 330211,
  "Patiāla": 329224,
  "Saugor": 328240,
  "Bijāpur": 327427,
  "Brahmapur": 324726,
  "Shāhjānpur": 320434,
  "Trichūr": 315596,
  "Barddhamān": 314265,
  "Kulti": 313809,
  "Sambalpur": 310852,
  "Purnea": 310817,
  "Hisar": 307024,
  "Fīrozābād": 306409,
  "Bīdar": 300136,
  "Rāmpur": 296418,
  "Shiliguri": 294546,
  "Bāli": 293373,
  "Pānīpat": 292808,
  "Karīmnagar": 289821,
  "Bhuj": 289429,
  "Ichalkaranji": 287570,
  "Tirupati": 287482,
  "Hospet": 286007,
  "Āīzawl": 283021,
  "Sannai": 283004,
  "Bārāsat": 278435,
  "Ratlām": 273892,
  "Handwāra": 269311,
  "Drug": 268806,
  "Imphāl": 268243,
  "Anantapur": 267161,
  "Etāwah": 257448,
  "Rāichūr": 255240,
  "Ongole": 252739,
  "Bharatpur": 252342,
  "Begusarai": 252008,
  "Sonīpat": 250521,
  "Rāmgundam": 242979,
  "Hāpur": 242920,
  "Uluberiya": 235345,
  "Porbandar": 234684,
  "Pāli": 229956,
  "Vizianagaram": 228720,
  "Puducherry": 227411,
  "Karnāl": 225049,
  "Nāgercoil": 224329,
  "Tanjore": 222943,
  "Sambhal": 220813,
  "Naihāti": 217900,
  "Secunderābād": 213698,
  "Kharagpur": 207604,
  "Dindigul": 207327,
  "Shimla": 206575,
  "Ingrāj Bāzār": 205521,
  "Ellore": 203780,
  "Puri": 201026,
  "Haldia": 200762,
  "Nandyāl": 200516,
  "Bulandshahr": 198612,
  "Chakradharpur": 197953,
  "Bhiwāni": 197662,
  "Gurgaon": 197340,
  "Burhānpur": 197233,
  "Khammam": 196283,
  "Madhyamgram": 196127,
  "Ghāndīnagar": 195891,
  "Baharampur": 195223,
  "Mahbūbnagar": 190400,
  "Mahesāna": 184991,
  "Ādoni": 184625,
  "Rāiganj": 183612,
  "Bhusāval": 183001,
  "Bahraigh": 182218,
  "Shrīrāmpur": 181842,
  "Tonk": 181734,
  "Sirsa": 181639,
  "Jaunpur": 180362,
  "Madanapalle": 180180,
  "Hugli": 179931,
  "Vellore": 177081,
  "Alleppey": 176783,
  "Cuddalore": 173676,
  "Deo": 173216,
  "Chīrāla": 172826,
  "Machilīpatnam": 169892,
  "Medinīpur": 169264,
  "Bāramūla": 167986,
  "Chandannagar": 166867,
  "Fatehpur": 166480,
  "Udipi": 165401,
  "Tenāli": 164937,
  "Sitalpur": 164435,
  "Conjeeveram": 164384,
  "Proddatūr": 163970,
  "Navsāri": 163000,
  "Godhra": 161925,
  "Budaun": 161555,
  "Chittoor": 160722,
  "Harīpur": 158142,
  "Saharsa": 156540,
  "Vidisha": 155959,
  "Pathānkot": 155909,
  "Nalgonda": 154326,
  "Dibrugarh": 154019,
  "Bālurghāt": 153279,
  "Krishnanagar": 153062,
  "Fyzābād": 153047,
  "Silchar": 152393,
  "Shāntipur": 151777,
  "Hindupur": 151677,
  "Erode": 151184,
  "Jāmuria": 149220,
  "Hābra": 147221,
  "Ambāla": 146787,
  "Mauli": 146213,
  "Kolār": 144625,
  "Shillong": 143229,
  "Bhīmavaram": 142184,
  "New Delhi": 142004,
  "Mandsaur": 141667,
  "Kumbakonam": 139264,
  "Tiruvannāmalai": 138243,
  "Chicacole": 137944,
  "Bānkura": 137386,
  "Mandya": 137358,
  "Hassan": 133436,
  "Yavatmāl": 132000,
  "Pīlibhīt": 131008,
  "Pālghāt": 130955,
  "Abohar": 130603,
  "Pālakollu": 129717,
  "Kānchrāpāra": 129576,
  "Port Blair": 127562,
  "Alīpur Duār": 127342,
  "Hāthras": 126882,
  "Guntakal": 126270,
  "Navadwīp": 125543,
  "Basīrhat": 125254,
  "Hālīsahar": 124939,
  "Rishra": 124577,
  "Dharmavaram": 121874,
  "Baidyabāti": 121110,
  "Darjeeling": 118805,
  "Sopur": 118608,
  "Gudivāda": 118167,
  "Adilābād": 117167,
  "Titāgarh": 116541,
  "Chittaurgarh": 116406,
  "Narasaraopet": 116250,
  "Dam Dam": 114786,
  "Vālpārai": 114308,
  "Osmānābād": 112085,
  "Champdani": 111251,
  "Bangaon": 108864,
  "Khardah": 108496,
  "Tādpatri": 108171,
  "Jalpāiguri": 107341,
  "Suriāpet": 106805,
  "Tādepallegūdem": 104032,
  "Bānsbāria": 103920,
  "Negapatam": 102905,
  "Bhadreswar": 101477,
  "Chilakalūrupet": 101398,
  "Kalyani": 100575,
  "Gangtok": 100286,
  "Kohīma": 99039,
  "Khambhāt": 98700,
  "Emmiganūr": 95149,
  "Rāyachoti": 91234,
  "Kāvali": 90099,
  "Mancherāl": 89935,
  "Kadiri": 89429,
  "Ootacamund": 88430,
  "Anakāpalle": 86519,
  "Sirsilla": 83186,
  "Kāmāreddipet": 80315,
  "Pāloncha": 80199,
  "Kottagūdem": 79819,
  "Tanuku": 77962,
  "Bodhan": 77573,
  "Karūr": 76915,
  "Mangalagiri": 73613,
  "Kairāna": 73046,
  "Mārkāpur": 71092,
  "Malaut": 70958,
  "Bāpatla": 70777,
  "Badvel": 70626,
  "Jorhāt": 69033,
  "Koratla": 66504,
  "Pulivendla": 65706,
  "Jaisalmer": 65471,
  "Tādepalle": 64149,
  "Armūr": 64023,
  "Jatani": 63697,
  "Gadwāl": 63177,
  "Nagari": 62253,
  "Wanparti": 60949,
  "Ponnūru": 59913,
  "Vinukonda": 59725,
  "Itānagar": 59490,
  "Tezpur": 58851,
  "Narasapur": 58770,
  "Kothāpet": 57583,
  "Mācherla": 57290,
  "Kandukūr": 57246,
  "Sāmalkot": 56864,
  "Bobbili": 56819,
  "Sattenapalle": 56721,
  "Vrindāvan": 56618,
  "Mandapeta": 56063,
  "Belampalli": 55841,
  "Bhīmunipatnam": 55082,
  "Nāndod": 54923,
  "Pithāpuram": 54859,
  "Punganūru": 54746,
  "Puttūr": 54092,
  "Jalor": 54081,
  "Palmaner": 54035,
  "Dholka": 53792,
  "Jaggayyapeta": 53530,
  "Tuni": 53425,
  "Amalāpuram": 53231,
  "Jagtiāl": 53213,
  "Vikārābād": 53143,
  "Venkatagiri": 52688,
  "Sihor": 52603,
  "Jangaon": 52394,
  "Mandamāri": 52352,
  "Metpalli": 50902,
  "Repalle": 50866,
  "Bhainsa": 49764,
  "Jasdan": 48483,
  "Jammalamadugu": 46069,
  "Rāmeswaram": 44856,
  "Addanki": 43850,
  "Nidadavole": 43809,
  "Bodupāl": 43692,
  "Rājgīr": 41587,
  "Rajaori": 41552,
  "Naini Tal": 41377,
  "Channarāyapatna": 40400,
  "Maihar": 40192,
  "Panaji": 40017,
  "Junnar": 40000,
  "Amudālavalasa": 39799,
  "Damān": 39737,
  "Kovvūr": 39667,
  "Solan": 39256,
  "Dwārka": 38873,
  "Pathanāmthitta": 37802,
  "Kodaikānal": 36501,
  "Udhampur": 35507,
  "Giddalūr": 35150,
  "Yellandu": 35056,
  "Shrīrangapattana": 34135,
  "Angamāli": 33424,
  "Umaria": 33114,
  "Fatehpur Sīkri": 32905,
  "Mangūr": 32091,
  "Pedana": 30721,
  "Uran": 30439,
  "Chimākurti": 30279,
  "Devarkonda": 29731,
  "Bandipura": 27482,
  "Silvassa": 27359,
  "Pāmidi": 26886,
  "Narasannapeta": 26280,
  "Jaynagar-Majilpur": 25922,
  "Khed Brahma": 25001,
  "Khajurāho": 24481,
  "Koilkuntla": 23859,
  "Diu": 23779,
  "Kulgam": 23584,
  "Gauripur": 23477,
  "Abu": 22943,
  "Curchorem": 22730,
  "Kavaratti": 10688,
  "Panchkula": 0,
  "Kagaznāgār": 0
}

function getVaccineData(city) {
    return JSON.parse($.ajax({
        async: false,
        url: 'vaccineCSV.php',
        type: 'POST',
        data: {city: city},
        dataType: 'JSON',
        success:function(response) {}
    }).responseText);
}

var city = document.getElementById("hiddenCity").value;
var vaccineData = getVaccineData(city);
var formattedData = [];

for (var i = 6; i < vaccineData[0].length; i += 10) {
    if (vaccineData[0][i] != "" && vaccineData[1][i] != "") {
      var data = {};
      data['date'] = new Date(vaccineData[0][i].split("/").reverse().join("-"));
      data['TotalIndividualsRegistered'] = parseInt(vaccineData[1][i]);
      data['TotalSessionsConducted'] = parseInt(vaccineData[1][i + 1]);
      data['TotalSites'] = parseInt(vaccineData[1][i + 2]);
      data['FirstDoseAdministered'] = parseInt(vaccineData[1][i + 3]);
      data['SecondDoseAdministered'] = parseInt(vaccineData[1][i + 4]);
      data['Male'] = parseInt(vaccineData[1][i + 5]);
      data['Female'] = parseInt(vaccineData[1][i + 6]);
      data['Transgender'] = parseInt(vaccineData[1][i + 7]);
      data['TotalCovaxinAdministered'] = parseInt(vaccineData[1][i + 8]);
      data['TotalCoviShieldAdministered'] = parseInt(vaccineData[1][i + 9]);
      data['TotalVaccine'] = parseInt(vaccineData[1][i + 8]) + parseInt(vaccineData[1][i + 9]);
      formattedData.push(data);
    }
}

am4core.ready(function() {
    am4core.useTheme(am4themes_animated);
    var chart = am4core.create("totalVaccine", am4charts.XYChart);

    chart.data = formattedData;

    var dateAxis = chart.xAxes.push(new am4charts.DateAxis());
    dateAxis.renderer.minGridDistance = 50;

    var valueAxis = chart.yAxes.push(new am4charts.ValueAxis());

    var series = chart.series.push(new am4charts.LineSeries());
    series.dataFields.valueY = "TotalVaccine";
    series.dataFields.dateX = "date";
    series.strokeWidth = 2;
    series.minBulletDistance = 10;
    series.tooltipText = "{valueY}";
    series.tooltip.pointerOrientation = "vertical";
    series.tooltip.background.cornerRadius = 20;
    series.tooltip.background.fillOpacity = 0.5;
    series.tooltip.label.padding(12,12,12,12)

    chart.scrollbarX = new am4charts.XYChartScrollbar();
    chart.scrollbarX.series.push(series);

    chart.cursor = new am4charts.XYCursor();
    chart.cursor.xAxis = dateAxis;
    chart.cursor.snapToSeries = series;

    function generateChartData() {
        var chartData = [];
        var firstDate = new Date();
        firstDate.setDate(firstDate.getDate() - 1000);
        var visits = 1200;
        for (var i = 0; i < 500; i++) {
            var newDate = new Date(firstDate);
            newDate.setDate(newDate.getDate() + i);

            visits += Math.round((Math.random()<0.5?1:-1)*Math.random()*10);

            chartData.push({
                date: newDate,
                visits: visits
            });
        }
        return chartData;
    }
});

am4core.ready(function() {
    am4core.useTheme(am4themes_animated);

    var chart = am4core.create("gender", am4charts.PieChart);

    chart.data = [
        {
          "Gender": "Male",
          "Vaccinated": data['Male']
        }, {
          "Gender": "Female",
          "Vaccinated": data['Female']
        }, {
          "Gender": "Transgender",
          "Vaccinated": data['Transgender']
        }
    ];

    var pieSeries = chart.series.push(new am4charts.PieSeries());
    pieSeries.dataFields.value = "Vaccinated";
    pieSeries.dataFields.category = "Gender";
    pieSeries.slices.template.stroke = am4core.color("#fff");
    pieSeries.slices.template.strokeWidth = 2;
    pieSeries.slices.template.strokeOpacity = 1;

    pieSeries.hiddenState.properties.opacity = 1;
    pieSeries.hiddenState.properties.endAngle = -90;
    pieSeries.hiddenState.properties.startAngle = -90;

});

am4core.ready(function() {
    am4core.useTheme(am4themes_animated);

    var chart = am4core.create("vaccine", am4charts.PieChart);

    chart.data = [
        {
          "Vaccine": "Covaxin",
          "Administered": data['TotalCovaxinAdministered']
        }, {
          "Vaccine": "CoviShield",
          "Administered": data['TotalCoviShieldAdministered']
        }
    ];

    var pieSeries = chart.series.push(new am4charts.PieSeries());
    pieSeries.dataFields.value = "Administered";
    pieSeries.dataFields.category = "Vaccine";
    pieSeries.slices.template.stroke = am4core.color("#fff");
    pieSeries.slices.template.strokeWidth = 2;
    pieSeries.slices.template.strokeOpacity = 1;

    pieSeries.hiddenState.properties.opacity = 1;
    pieSeries.hiddenState.properties.endAngle = -90;
    pieSeries.hiddenState.properties.startAngle = -90;

});

var firstDoseAdministered = data['FirstDoseAdministered'] / city_population[city] * 100;
var SecondDoseAdministered = data['SecondDoseAdministered'] / city_population[city] * 100;
am4core.ready(function() {
    am4core.useTheme(am4themes_animated);

    var chartMin = 0;
    var chartMax = 100;

    var data = {
      score: firstDoseAdministered,
      gradingData: [
        {
          title: "Less than 25%",
          color: "#ee1f25",
          lowScore: 0,
          highScore: 25
        },
        {
          title: "Less than 50%",
          color: "#f04922",
          lowScore: 25,
          highScore: 50
        },
        {
          title: "Greater than 50%",
          color: "#54b947",
          lowScore: 50,
          highScore: 75
        },
        {
          title: "Nearing 100%",
          color: "#0f9747",
          lowScore: 75,
          highScore: 100
        }
      ]
    };

    /**
    Grading Lookup
     */
    function lookUpGrade(lookupScore, grades) {
      // Only change code below this line
      for (var i = 0; i < grades.length; i++) {
        if (
          grades[i].lowScore < lookupScore &&
          grades[i].highScore >= lookupScore
        ) {
          return grades[i];
        }
      }
      return null;
    }

    var chart = am4core.create("firstDose", am4charts.GaugeChart);
    chart.hiddenState.properties.opacity = 0;
    chart.fontSize = 11;
    chart.innerRadius = am4core.percent(80);
    chart.resizable = true;

    /**
     * Normal axis
     */
    var axis = chart.xAxes.push(new am4charts.ValueAxis());
    axis.min = chartMin;
    axis.max = chartMax;
    axis.strictMinMax = true;
    axis.renderer.radius = am4core.percent(80);
    axis.renderer.inside = true;
    axis.renderer.line.strokeOpacity = 0.1;
    axis.renderer.ticks.template.disabled = false;
    axis.renderer.ticks.template.strokeOpacity = 1;
    axis.renderer.ticks.template.strokeWidth = 0.5;
    axis.renderer.ticks.template.length = 5;
    axis.renderer.grid.template.disabled = true;
    axis.renderer.labels.template.radius = am4core.percent(15);
    axis.renderer.labels.template.fontSize = "0.9em";

    /**
     * Axis for ranges
     */
    var axis2 = chart.xAxes.push(new am4charts.ValueAxis());
    axis2.min = chartMin;
    axis2.max = chartMax;
    axis2.strictMinMax = true;
    axis2.renderer.labels.template.disabled = true;
    axis2.renderer.ticks.template.disabled = true;
    axis2.renderer.grid.template.disabled = false;
    axis2.renderer.grid.template.opacity = 0.5;
    axis2.renderer.labels.template.bent = true;
    axis2.renderer.labels.template.fill = am4core.color("#000");
    axis2.renderer.labels.template.fontWeight = "bold";
    axis2.renderer.labels.template.fillOpacity = 0.3;

    /**
    Ranges
    */
    for (let grading of data.gradingData) {
      var range = axis2.axisRanges.create();
      range.axisFill.fill = am4core.color(grading.color);
      range.axisFill.fillOpacity = 0.8;
      range.axisFill.zIndex = -1;
      range.value = grading.lowScore > chartMin ? grading.lowScore : chartMin;
      range.endValue = grading.highScore < chartMax ? grading.highScore : chartMax;
      range.grid.strokeOpacity = 0;
      range.stroke = am4core.color(grading.color).lighten(-0.1);
      range.label.inside = true;
      range.label.text = grading.title.toUpperCase();
      range.label.inside = true;
      range.label.location = 0.5;
      range.label.inside = true;
      range.label.radius = am4core.percent(10);
      range.label.paddingBottom = -5; // ~half font size
      range.label.fontSize = "0.9em";
    }

    var matchingGrade = lookUpGrade(data.score, data.gradingData);

    /**
     * Label 1
     */
    var label = chart.radarContainer.createChild(am4core.Label);
    label.isMeasured = false;
    label.fontSize = "6em";
    label.x = am4core.percent(50);
    label.paddingBottom = 15;
    label.horizontalCenter = "middle";
    label.verticalCenter = "bottom";
    //label.dataItem = data;
    label.text = data.score.toFixed(1);
    //label.text = "{score}";
    label.fill = am4core.color(matchingGrade.color);

    /**
     * Label 2
     */
    var label2 = chart.radarContainer.createChild(am4core.Label);
    label2.isMeasured = false;
    label2.fontSize = "2em";
    label2.horizontalCenter = "middle";
    label2.verticalCenter = "bottom";
    label2.text = matchingGrade.title.toUpperCase();
    label2.fill = am4core.color(matchingGrade.color);

    /**
     * Hand
     */
    var hand = chart.hands.push(new am4charts.ClockHand());
    hand.axis = axis2;
    hand.innerRadius = am4core.percent(55);
    hand.startWidth = 8;
    hand.pin.disabled = true;
    hand.value = data.score;
    hand.fill = am4core.color("#444");
    hand.stroke = am4core.color("#000");
});

am4core.ready(function() {
    am4core.useTheme(am4themes_animated);

    var chartMin = 0;
    var chartMax = 100;

    var data = {
      score: SecondDoseAdministered,
      gradingData: [
        {
          title: "Less than 25%",
          color: "#ee1f25",
          lowScore: 0,
          highScore: 25
        },
        {
          title: "Less than 50%",
          color: "#f04922",
          lowScore: 25,
          highScore: 50
        },
        {
          title: "Greater than 50%",
          color: "#54b947",
          lowScore: 50,
          highScore: 75
        },
        {
          title: "Nearing 100%",
          color: "#0f9747",
          lowScore: 75,
          highScore: 100
        }
      ]
    };

    /**
    Grading Lookup
     */
    function lookUpGrade(lookupScore, grades) {
      // Only change code below this line
      for (var i = 0; i < grades.length; i++) {
        if (
          grades[i].lowScore < lookupScore &&
          grades[i].highScore >= lookupScore
        ) {
          return grades[i];
        }
      }
      return null;
    }

    var chart = am4core.create("secondDose", am4charts.GaugeChart);
    chart.hiddenState.properties.opacity = 0;
    chart.fontSize = 11;
    chart.innerRadius = am4core.percent(80);
    chart.resizable = true;

    /**
     * Normal axis
     */
    var axis = chart.xAxes.push(new am4charts.ValueAxis());
    axis.min = chartMin;
    axis.max = chartMax;
    axis.strictMinMax = true;
    axis.renderer.radius = am4core.percent(80);
    axis.renderer.inside = true;
    axis.renderer.line.strokeOpacity = 0.1;
    axis.renderer.ticks.template.disabled = false;
    axis.renderer.ticks.template.strokeOpacity = 1;
    axis.renderer.ticks.template.strokeWidth = 0.5;
    axis.renderer.ticks.template.length = 5;
    axis.renderer.grid.template.disabled = true;
    axis.renderer.labels.template.radius = am4core.percent(15);
    axis.renderer.labels.template.fontSize = "0.9em";

    /**
     * Axis for ranges
     */
    var axis2 = chart.xAxes.push(new am4charts.ValueAxis());
    axis2.min = chartMin;
    axis2.max = chartMax;
    axis2.strictMinMax = true;
    axis2.renderer.labels.template.disabled = true;
    axis2.renderer.ticks.template.disabled = true;
    axis2.renderer.grid.template.disabled = false;
    axis2.renderer.grid.template.opacity = 0.5;
    axis2.renderer.labels.template.bent = true;
    axis2.renderer.labels.template.fill = am4core.color("#000");
    axis2.renderer.labels.template.fontWeight = "bold";
    axis2.renderer.labels.template.fillOpacity = 0.3;

    /**
    Ranges
    */
    for (let grading of data.gradingData) {
      var range = axis2.axisRanges.create();
      range.axisFill.fill = am4core.color(grading.color);
      range.axisFill.fillOpacity = 0.8;
      range.axisFill.zIndex = -1;
      range.value = grading.lowScore > chartMin ? grading.lowScore : chartMin;
      range.endValue = grading.highScore < chartMax ? grading.highScore : chartMax;
      range.grid.strokeOpacity = 0;
      range.stroke = am4core.color(grading.color).lighten(-0.1);
      range.label.inside = true;
      range.label.text = grading.title.toUpperCase();
      range.label.inside = true;
      range.label.location = 0.5;
      range.label.inside = true;
      range.label.radius = am4core.percent(10);
      range.label.paddingBottom = -5; // ~half font size
      range.label.fontSize = "0.9em";
    }

    var matchingGrade = lookUpGrade(data.score, data.gradingData);

    /**
     * Label 1
     */
    var label = chart.radarContainer.createChild(am4core.Label);
    label.isMeasured = false;
    label.fontSize = "6em";
    label.x = am4core.percent(50);
    label.paddingBottom = 15;
    label.horizontalCenter = "middle";
    label.verticalCenter = "bottom";
    //label.dataItem = data;
    label.text = data.score.toFixed(1);
    //label.text = "{score}";
    label.fill = am4core.color(matchingGrade.color);

    /**
     * Label 2
     */
    var label2 = chart.radarContainer.createChild(am4core.Label);
    label2.isMeasured = false;
    label2.fontSize = "2em";
    label2.horizontalCenter = "middle";
    label2.verticalCenter = "bottom";
    label2.text = matchingGrade.title.toUpperCase();
    label2.fill = am4core.color(matchingGrade.color);

    /**
     * Hand
     */
    var hand = chart.hands.push(new am4charts.ClockHand());
    hand.axis = axis2;
    hand.innerRadius = am4core.percent(55);
    hand.startWidth = 8;
    hand.pin.disabled = true;
    hand.value = data.score;
    hand.fill = am4core.color("#444");
    hand.stroke = am4core.color("#000");
});
